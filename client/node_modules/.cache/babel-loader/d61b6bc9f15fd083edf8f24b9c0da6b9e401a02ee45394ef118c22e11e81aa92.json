{"ast":null,"code":"import React,{useState,useEffect}from'react';import Cookies from'js-cookie';import Header from'../Header/Header';import{useNavigate}from'react-router-dom';import'./cart.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Cart=()=>{const[cartItems,setCartItems]=useState([]);const userId=Cookies.get('userId');const navigate=useNavigate();useEffect(()=>{const fetchCartItems=async()=>{try{const token=Cookies.get('authToken');if(!token){console.error('No auth token found!');return;}const response=await fetch(\"/api/cart/\".concat(userId),{method:'GET',headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'},credentials:'include'});if(!response.ok){throw new Error('Failed to fetch cart items');}const data=await response.json();setCartItems(data);}catch(error){console.error('Error fetching cart items:',error);}};if(userId){fetchCartItems();}},[userId]);const handleRemoveFromCart=async productId=>{try{const token=Cookies.get('authToken');if(!token){console.error('No auth token found!');return;}const response=await fetch(\"/api/cart/\".concat(userId,\"/\").concat(productId),{method:'DELETE',headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'},credentials:'include'});if(!response.ok){throw new Error('Failed to remove item from cart');}setCartItems(prevItems=>prevItems.filter(item=>item.product_id!==productId));console.log('Item removed successfully!');}catch(error){console.error('Error removing item from cart:',error);}};const handleUpdateQuantity=async(productId,quantity)=>{if(quantity<1){console.log('Quantity cannot be less than 1');return;}/*try {\r\n      const token = Cookies.get('authToken');\r\n\r\n      if (!token) {\r\n        console.error('No auth token found!');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(`/api/cart/${userId}/${productId}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({ quantity }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to update quantity');\r\n      }\r\n\r\n      setCartItems((prevItems) =>\r\n        prevItems.map(item =>\r\n          item.product_id === productId ? { ...item, quantity } : item\r\n        )\r\n      );\r\n      console.log('Quantity updated successfully!');\r\n    } catch (error) {\r\n      console.error('Error updating quantity:', error);\r\n    } */};const handleCheckout=async()=>{try{const token=Cookies.get('authToken');if(!token){console.error('No auth token found!');return;}/* const response = await fetch('/api/checkout', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          user_id: userId, // Ensure this is the correct user ID\r\n          cartItems,       // Send cart items to the backend for processing\r\n        }),\r\n      });\r\n  \r\n      if (!response.ok) {\r\n        throw new Error('Failed to checkout');\r\n      }\r\n  \r\n      // Optionally handle the response (e.g., order ID, success message)\r\n      const data = await response.json();\r\n      console.log('Order placed successfully!', data);\r\n  \r\n      // Clear cart items after successful checkout\r\n      setCartItems([]); */navigate('/payment');}catch(error){console.error('Error during checkout:',error);alert('Failed to process checkout.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"routes-bg\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-bg\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Shopping Cart\"}),/*#__PURE__*/_jsx(\"ul\",{children:cartItems.map(item=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Product Name: \",item.name]}),\" \",/*#__PURE__*/_jsxs(\"p\",{children:[\"Quantity: \",item.quantity]}),\" \",/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: $\",item.price]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRemoveFromCart(item.product_id),className:\"remove-btn\",children:\"Remove\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"inc-dec-btn\",onClick:()=>handleUpdateQuantity(item.product_id,item.quantity+1),children:\"+\"}),/*#__PURE__*/_jsx(\"span\",{children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{className:\"inc-dec-btn\",onClick:()=>handleUpdateQuantity(item.product_id,item.quantity-1),children:\"-\"})]})]},item.product_id))}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCheckout,className:\"checkout-btn\",children:\"Checkout\"})]})]});};export default Cart;","map":{"version":3,"names":["React","useState","useEffect","Cookies","Header","useNavigate","jsx","_jsx","jsxs","_jsxs","Cart","cartItems","setCartItems","userId","get","navigate","fetchCartItems","token","console","error","response","fetch","concat","method","headers","Authorization","credentials","ok","Error","data","json","handleRemoveFromCart","productId","prevItems","filter","item","product_id","log","handleUpdateQuantity","quantity","handleCheckout","alert","className","children","map","name","price","onClick"],"sources":["D:/Claw Enterprises/client/src/components/Cart/Cart.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Cookies from 'js-cookie';\r\nimport Header from '../Header/Header';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nimport './cart.css'\r\n\r\nconst Cart = () => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const userId = Cookies.get('userId');\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchCartItems = async () => {\r\n      try {\r\n        const token = Cookies.get('authToken');\r\n\r\n        if (!token) {\r\n          console.error('No auth token found!');\r\n          return;\r\n        }\r\n\r\n        const response = await fetch(`/api/cart/${userId}`, {\r\n          method: 'GET',\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n          credentials: 'include',\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch cart items');\r\n        }\r\n\r\n        const data = await response.json();\r\n        setCartItems(data);\r\n      } catch (error) {\r\n        console.error('Error fetching cart items:', error);\r\n      }\r\n    };\r\n\r\n    if (userId) {\r\n      fetchCartItems();\r\n    }\r\n  }, [userId]);\r\n\r\n  const handleRemoveFromCart = async (productId) => {\r\n    try {\r\n      const token = Cookies.get('authToken');\r\n\r\n      if (!token) {\r\n        console.error('No auth token found!');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(`/api/cart/${userId}/${productId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to remove item from cart');\r\n      }\r\n\r\n      setCartItems((prevItems) => prevItems.filter(item => item.product_id !== productId));\r\n      console.log('Item removed successfully!');\r\n    } catch (error) {\r\n      console.error('Error removing item from cart:', error);\r\n    }\r\n  };\r\n\r\n  const handleUpdateQuantity = async (productId, quantity) => {\r\n    if (quantity < 1) {\r\n      console.log('Quantity cannot be less than 1');\r\n      return;\r\n    }\r\n\r\n    /*try {\r\n      const token = Cookies.get('authToken');\r\n\r\n      if (!token) {\r\n        console.error('No auth token found!');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(`/api/cart/${userId}/${productId}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({ quantity }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to update quantity');\r\n      }\r\n\r\n      setCartItems((prevItems) =>\r\n        prevItems.map(item =>\r\n          item.product_id === productId ? { ...item, quantity } : item\r\n        )\r\n      );\r\n      console.log('Quantity updated successfully!');\r\n    } catch (error) {\r\n      console.error('Error updating quantity:', error);\r\n    } */\r\n\r\n      \r\n  };\r\n\r\n  const handleCheckout = async () => {\r\n    try {\r\n      const token = Cookies.get('authToken');\r\n  \r\n      if (!token) {\r\n        console.error('No auth token found!');\r\n        return;\r\n      }\r\n  \r\n      /* const response = await fetch('/api/checkout', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          user_id: userId, // Ensure this is the correct user ID\r\n          cartItems,       // Send cart items to the backend for processing\r\n        }),\r\n      });\r\n  \r\n      if (!response.ok) {\r\n        throw new Error('Failed to checkout');\r\n      }\r\n  \r\n      // Optionally handle the response (e.g., order ID, success message)\r\n      const data = await response.json();\r\n      console.log('Order placed successfully!', data);\r\n  \r\n      // Clear cart items after successful checkout\r\n      setCartItems([]); */\r\n      navigate('/payment')\r\n    } catch (error) {\r\n      console.error('Error during checkout:', error);\r\n      alert('Failed to process checkout.');\r\n    }\r\n  };\r\n  \r\n\r\n  return (\r\n    <div className='routes-bg'>\r\n      <Header />\r\n      <div className='cart-bg'>\r\n        <h1>Shopping Cart</h1>\r\n        <ul>\r\n          {cartItems.map((item) => (\r\n            <li key={item.product_id}>\r\n              <p>Product Name: {item.name}</p> <p>Quantity: {item.quantity}</p> <p>Price: ${item.price}</p> \r\n              <button onClick={() => handleRemoveFromCart(item.product_id)} className='remove-btn'>Remove</button>\r\n              <div>\r\n                <button className='inc-dec-btn' onClick={() => handleUpdateQuantity(item.product_id, item.quantity + 1)}>+</button>\r\n                <span>{item.quantity}</span>\r\n                <button className='inc-dec-btn' onClick={() => handleUpdateQuantity(item.product_id, item.quantity - 1)}>-</button>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n        <button onClick={handleCheckout} className='checkout-btn'>Checkout</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}